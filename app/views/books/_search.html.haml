:javascript  
  function searchfnc(searchquery, e, field){
    if(field == null || field == '')
      return;
    var type = e.options[e.selectedIndex].value;
    if(searchquery == null || searchquery == ''){
      searchquery = "_" + type + "=" + field;
    } 
    else if(searchquery.toLowerCase().indexOf("_" + type.toLowerCase()) != -1){
      searchquery = searchquery.replace("_" + type.toLowerCase() + "=","_" + type.toLowerCase() + "=" + field + " _AND ");
    }
    else{
      searchquery += "&_" + type + "=" + field;
    }
    url = window.location.href.split('?')[0]
    url = url.split('#')[0]
    window.location = url + "?" + searchquery;
  }
.topsearch
  - jsquery = set_query_string(@query_array, true)
  .input-append
    %span.separator.pull-left.searchicon
      %i.fa.fa-search.fa-lg.pull-left
    .col-xs-7
      %input.form-control{:id=> "searchfield", :type => "text", :onkeypress => "if(event.keyCode == 13){searchfnc('#{jsquery}', document.getElementById('searchby'), document.getElementById('searchfield').value);return false;}"}
    %span.separator.pull-left 
      |
    %select#searchby
      %option{:value => "ALL"} 
        = I18n.t(:option_all)
      %option{:value => "title", :selected => true} 
        = I18n.t(:option_title)
      %option{:value => "language"} 
        = I18n.t(:option_language)
      %option{:value => "published_on"} 
        = I18n.t(:option_publish_time)
      %option{:value => "geo_location"} 
        = I18n.t(:option_regional_affiliation)
      %option{:value => "author"} 
        = I18n.t(:option_author)
      %option{:value => "name"} 
        = I18n.t(:option_tagged_species)
      %option{:value => "subject"} 
        = I18n.t(:option_genre)
      %option{:value => "content"} 
        = I18n.t(:option_content)                                  
    .clearfix.visible-xs  
    %span.separator.pull-left 
      |    
  %a.go.pull-left{:href => "#", :onclick => "searchfnc('#{jsquery}', document.getElementById('searchby'), document.getElementById('searchfield').value); return false;"}
    %i.fa.fa-arrow-circle-right.fa-2x
  .clearfix